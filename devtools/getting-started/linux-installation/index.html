<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Phase2">
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Linux Installation - DevTools CLI Documentation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Linux Installation";
    var mkdocs_page_input_path = "getting-started/linux-installation.md";
    var mkdocs_page_url = "/getting-started/linux-installation/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-305109-83', 'auto');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> DevTools CLI Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">Home</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Getting Started</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../system-requirements/">System Requirements</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../mac-installation/">Mac Installation</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Linux Installation</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#linux-installation">Linux Installation</a></li>
                
                    <li><a class="toctree-l4" href="#linux-requirements">Linux Requirements</a></li>
                
                    <li><a class="toctree-l4" href="#linux-installation-on-fedora-22">Linux installation on Fedora 22+</a></li>
                
                    <li><a class="toctree-l4" href="#linux-installation-on-ubuntulinux-mintdebian">Linux installation on Ubuntu/Linux Mint/Debian</a></li>
                
                    <li><a class="toctree-l4" href="#linux-dns-configuration-options">Linux DNS configuration options</a></li>
                
                    <li><a class="toctree-l4" href="#verifying-dns-is-working">Verifying DNS is working</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../windows-installation/">Windows Installation</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../how-to-contribute/">How to contribute</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Project Setup</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../project-setup/common-setup/">Common Setup</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../project-setup/new-projects/">New Projects</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../project-setup/existing-projects/">Existing Projects</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../project-setup/docker-images/">Docker Images</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Common Tasks</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../common-tasks/starting-your-project-containers/">Starting your project containers</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../common-tasks/stopping-containers-and-cleanup/">Stopping containers and cleanup</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../common-tasks/using-the-build-container/">Using the build container</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../common-tasks/working-with-volumes/">Working with Volumes</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../common-tasks/ssh-into-a-container/">SSH into a container</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../common-tasks/using-watches/">Using watches</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../common-tasks/using-xdebug-with-phpstorm/">Using Xdebug with PHPStorm</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../common-tasks/accessing-logs/">Accessing logs</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../common-tasks/tbd/">Container configuration</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../common-tasks/customizing-container-configuration/">Changing container configuration</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../common-tasks/ssh-keys-for-private-repos/">SSH Keys for private repos</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../common-tasks/tbd/">Seting up mail</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../common-tasks/dns-resolution/">DNS Resolution</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../common-tasks/upgrading-devtools/">Upgrading DevTools</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../common-tasks/multiple-docker-machines/">Multiple Docker Machines</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../common-tasks/routine-image-maintenance/">Routine Image Maintenance</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../common-tasks/creating-your-own-images/">Creating your own images</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>FAQ</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../faq/general/">General</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../faq/troubleshooting/">Troubleshooting</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Appendix</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../appendix/glossary/">Glossary</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../appendix/architecture/">Architecture</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../appendix/background/">Background</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../appendix/library/">Library</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">DevTools CLI Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Getting Started &raquo;</li>
        
      
    
    <li>Linux Installation</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://bitbucket.org/phase2tech/devtools-cli/src/default/docs/getting-started/linux-installation.md"
          class="icon icon-bitbucket"
        > Edit on Bitbucket</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="linux-installation">Linux Installation</h1>
<p>When running Docker containers on Linux, it is not necessary to run the Docker Machine VM. The instructions here describe 
how to run DevTools projects on Linux.</p>
<h2 id="linux-requirements">Linux Requirements</h2>
<ol>
<li>The dnsdock container, used to support automatic creation and maintenance of DNS namespace for the containers</li>
<li>Use of one of three options to forward DNS queries to the dnsdock container 
(see <a href="#markdown-header-linux-dns-configuration-options">Linux DNS configuration options</a> below)</li>
</ol>
<h2 id="linux-installation-on-fedora-22">Linux installation on Fedora 22+</h2>
<ol>
<li>Install Docker 1.x.x and docker-compose<ul>
<li><code>sudo dnf install docker-engine docker-compose</code></li>
</ul>
</li>
<li>Add your user to the Docker group<ul>
<li><code>sudo usermod -aG docker $USER</code></li>
</ul>
</li>
<li>Log out, then back in, in order to pick up your new group assignments</li>
<li>Set the DNS configuration for dnsdock<ul>
<li>We need to modify the command that docker uses within systemd</li>
<li><code>sudo mkdir /etc/systemd/system/docker.service.d</code></li>
<li><code>sudo vi /etc/systemd/system/docker.service.d/docker.conf</code></li>
<li>In that file put something like the following:  <br />
<code>[Service]
    ExecStart=
    ExecStart=/usr/bin/dockerd -H fd:// --dns=172.17.0.1</code></li>
</ul>
</li>
<li>Set up the docker0 network as trusted<ul>
<li><code>sudo firewall-cmd --zone=trusted --add-interface=docker0 &amp;&amp; sudo firewall-cmd --zone=trusted --add-interface=docker0 --permanent</code></li>
</ul>
</li>
<li>Start the docker daemon<ul>
<li><code>sudo systemctl start docker</code></li>
</ul>
</li>
</ol>
<h2 id="linux-installation-on-ubuntulinux-mintdebian">Linux installation on Ubuntu/Linux Mint/Debian</h2>
<ol>
<li>Install Docker 1.x.x<ul>
<li><code>sudo apt-get install docker-engine</code></li>
</ul>
</li>
<li>Install Pip<ul>
<li><code>sudo apt-get install python-pip</code></li>
</ul>
</li>
<li>Install docker-compose<ul>
<li><code>sudo pip install docker-compose</code></li>
</ul>
</li>
<li>Add your user to the Docker group<ul>
<li><code>sudo usermod -aG docker $USER</code></li>
</ul>
</li>
<li>Log out, then back in, in order to pick up your new group assignments</li>
<li>Set the DNS configuration for dnsdock, as well as known RFC-1918 address space<ul>
<li>Please note that the following command will over-write your existing Docker daemon configuration file.  Please 
set the -dns=172.17.0.1 option manually as an alternative</li>
<li><code>echo 'DOCKER_OPTS="-dns=172.17.0.1"' | sudo tee /etc/default/docker</code></li>
</ul>
</li>
<li>Start the docker daemon<ul>
<li><code>sudo start docker</code></li>
</ul>
</li>
</ol>
<h2 id="linux-dns-configuration-options">Linux DNS configuration options</h2>
<h3 id="method-1-dnsmasq-via-networkmanager">Method 1: dnsmasq via NetworkManager</h3>
<p>This method works well with no other needed software provided that you have unfettered access to your system's 
configuration, and are using NetworkManager to maintain your networking stack</p>
<ol>
<li>Add the line dns=dnsmasq to /etc/NetworkManager/NetworkManager.conf under the [main] configuration stanza. This will 
cause NetworkManager to spawn and use a dnsmasq process for all name resolution. If you already have a local configuration, 
ensure that it is not configured to start on system boot.</li>
<li>Add a single rule to direct all DNS lookups for .vm addresses to the 172.17.0.1 address.<ul>
<li><code>echo 'server=/vm/172.17.0.1' | sudo tee /etc/NetworkManager/dnsmasq.d/dnsdock.conf</code></li>
</ul>
</li>
<li>Restart NetworkManager, either through systemd, or by simply rebooting.  To restart via systemd:<ul>
<li><code>systemctl restart NetworkManager</code></li>
</ul>
</li>
<li>Run the dnsdock container<ul>
<li><code>docker run -d --name=dnsdock -e DNSDOCK_NAME=dnsdock -e DNSDOCK_IMAGE=devtools -p 172.17.0.1:53:53/udp -v /var/run/docker.sock:/var/run/docker.sock aacebedo/dnsdock:latest-amd64 -domain=vm</code></li>
<li><em>Note</em>: if you want this container to run automatically when the docker daemon starts, add the <code>--restart=always</code> 
flag to the above command.</li>
</ul>
</li>
</ol>
<h3 id="method-2-dnsdock-as-main-resolver">Method 2: dnsdock as main resolver</h3>
<p>This method will probably only work well if this is a fixed computer or server with a consistent single upstream DNS 
server. If you meet these criteria, you can very easily use this to set up .vm resolution for containers an delegate the 
rest to your normal DNS server.</p>
<p>This example assumes that the upstream DNS server for a Linux workstation is 192.168.0.1.</p>
<ol>
<li>
<p>Run the dnsdock container, specifying your upstream DNS server at the end.</p>
<ul>
<li><code>docker run -d --name=dnsdock -e DNSDOCK_NAME=dnsdock -e DNSDOCK_IMAGE=devtools -p 172.17.0.1:53:53/udp -v /var/run/docker.sock:/var/run/docker.sock aacebedo/dnsdock:latest-amd64 /opt/bin/dnsdock -domain=vm -nameserver="192.168.0.1:53"</code></li>
<li><em>Note</em>: if you want this container to run automatically when the docker daemon starts, add the <code>--restart=always</code> 
flag to the above command.</li>
</ul>
</li>
<li>
<p>Configure 172.17.0.1 as your first DNS resolver in your network configuration. The method for doing this may differ 
based on whether you are using a desktop environment or running Linux on a server, but that nameserver should end up as 
the first 'nameserver' line in your /etc/resolv.conf file.</p>
</li>
</ol>
<h3 id="method-3-libnss-resolver">Method 3: libnss-resolver</h3>
<p>libnss-resolver is an app that adds Mac-style /etc/resolver/$FQDN files to the Linux NSS resolution stack to query a 
different DNS server for any .vm address.  It may be the easiest option for most installations.</p>
<p>There are releases for Fedora 20, Ubuntu 12.04 and Ubuntu 14.04.</p>
<ol>
<li>Install libnss-resolver from https://github.com/azukiapp/libnss-resolver/releases</li>
<li>Set up .vm hostname resolution<ul>
<li><code>echo 'nameserver 172.17.0.1:53' | sudo tee /etc/resolver/vm</code></li>
</ul>
</li>
<li>Run the dnsdock container<ul>
<li><code>docker run -d --name=dnsdock -e DNSDOCK_NAME=dnsdock -e DNSDOCK_IMAGE=devtools -p 172.17.0.1:53:53/udp -v /var/run/docker.sock:/var/run/docker.sock aacebedo/dnsdock:latest-amd64 -domain=vm</code></li>
<li><em>Note</em>: if you want this container to run automatically when the docker daemon starts, add the <code>--restart=always</code> 
flag to the above command.</li>
</ul>
</li>
</ol>
<h2 id="verifying-dns-is-working">Verifying DNS is working</h2>
<p>Once you have your environment set up, you can use the following tests to ensure things are running properly.</p>
<ul>
<li><code>dig @172.17.0.1 dnsdock.devtools.vm.</code><ul>
<li>You should get a 172.17.0.0/16 address.</li>
</ul>
</li>
<li><code>ping dnsdock.devtools.vm</code><ul>
<li>You should get echo replies from a 172.17.0.0/16 address.</li>
</ul>
</li>
<li><code>getent hosts dnsdock.devtools.vm</code><ul>
<li>You should get a 172.17.0.0/16 address.</li>
</ul>
</li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../windows-installation/" class="btn btn-neutral float-right" title="Windows Installation">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../mac-installation/" class="btn btn-neutral" title="Mac Installation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://bitbucket.org/phase2tech/devtools-cli" class="icon icon-bitbucket" style="float: left; color: #fcfcfc"> BitBucket</a>
      
      
        <span><a href="../mac-installation/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../windows-installation/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../../js/theme.js"></script>

</body>
</html>
